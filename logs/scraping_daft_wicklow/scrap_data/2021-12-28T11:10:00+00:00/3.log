[2021-12-29 12:47:47,288] {taskinstance.py:1035} INFO - Dependencies all met for <TaskInstance: scraping_daft_wicklow.scrap_data scheduled__2021-12-28T11:10:00+00:00 [queued]>
[2021-12-29 12:47:47,857] {taskinstance.py:1035} INFO - Dependencies all met for <TaskInstance: scraping_daft_wicklow.scrap_data scheduled__2021-12-28T11:10:00+00:00 [queued]>
[2021-12-29 12:47:47,870] {taskinstance.py:1241} INFO - 
--------------------------------------------------------------------------------
[2021-12-29 12:47:47,885] {taskinstance.py:1242} INFO - Starting attempt 3 of 4
[2021-12-29 12:47:47,903] {taskinstance.py:1243} INFO - 
--------------------------------------------------------------------------------
[2021-12-29 12:47:48,348] {taskinstance.py:1262} INFO - Executing <Task(SparkSubmitOperator): scrap_data> on 2021-12-28 11:10:00+00:00
[2021-12-29 12:47:48,597] {standard_task_runner.py:76} INFO - Running: ['***', 'tasks', 'run', 'scraping_daft_wicklow', 'scrap_data', 'scheduled__2021-12-28T11:10:00+00:00', '--job-id', '5382', '--raw', '--subdir', 'DAGS_FOLDER/scraping_daft_wicklow.py', '--cfg-path', '/tmp/tmpwkgiubyg', '--error-file', '/tmp/tmpchtk8niw']
[2021-12-29 12:47:48,614] {standard_task_runner.py:77} INFO - Job 5382: Subtask scrap_data
[2021-12-29 12:47:48,535] {standard_task_runner.py:52} INFO - Started process 33643 to run task
[2021-12-29 12:47:52,746] {logging_mixin.py:109} INFO - Running <TaskInstance: scraping_daft_wicklow.scrap_data scheduled__2021-12-28T11:10:00+00:00 [running]> on host 6bdda4c19a85
[2021-12-29 12:47:55,972] {taskinstance.py:1429} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_EMAIL=clement.liscoet@gmail.com
AIRFLOW_CTX_DAG_OWNER=clemoni
AIRFLOW_CTX_DAG_ID=scraping_daft_wicklow
AIRFLOW_CTX_TASK_ID=scrap_data
AIRFLOW_CTX_EXECUTION_DATE=2021-12-28T11:10:00+00:00
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2021-12-28T11:10:00+00:00
[2021-12-29 12:47:56,492] {base.py:79} INFO - Using connection to: id: spark_default. Host: spark://spark:7077, Port: None, Schema: , Login: ***, Password: ***, extra: {}
[2021-12-29 12:47:56,525] {spark_submit.py:360} INFO - Spark-Submit cmd: spark-submit --master spark://spark:7077 --conf spark.master=spark://spark:7077 --name scrap data --verbose /opt/***/jobs/get_ads_per_county.py wicklow
[2021-12-29 12:57:58,766] {spark_submit.py:514} INFO - Using properties file: null
[2021-12-29 12:59:15,666] {spark_submit.py:514} INFO - WARNING: An illegal reflective access operation has occurred
[2021-12-29 12:59:15,678] {spark_submit.py:514} INFO - WARNING: Illegal reflective access by org.apache.spark.unsafe.Platform (file:/home/***/.local/lib/python3.6/site-packages/pyspark/jars/spark-unsafe_2.12-3.2.0.jar) to constructor java.nio.DirectByteBuffer(long,int)
[2021-12-29 12:59:15,685] {spark_submit.py:514} INFO - WARNING: Please consider reporting this to the maintainers of org.apache.spark.unsafe.Platform
[2021-12-29 12:59:15,690] {spark_submit.py:514} INFO - WARNING: Use --illegal-access=warn to enable warnings of further illegal reflective access operations
[2021-12-29 12:59:15,698] {spark_submit.py:514} INFO - WARNING: All illegal access operations will be denied in a future release
[2021-12-29 12:59:58,678] {spark_submit.py:514} INFO - Parsed arguments:
[2021-12-29 12:59:58,704] {spark_submit.py:514} INFO - master                  spark://spark:7077
[2021-12-29 12:59:58,781] {spark_submit.py:514} INFO - deployMode              null
[2021-12-29 12:59:58,800] {spark_submit.py:514} INFO - executorMemory          null
[2021-12-29 12:59:59,041] {spark_submit.py:514} INFO - executorCores           null
[2021-12-29 12:59:59,069] {spark_submit.py:514} INFO - totalExecutorCores      null
[2021-12-29 12:59:59,095] {spark_submit.py:514} INFO - propertiesFile          null
[2021-12-29 12:59:59,137] {spark_submit.py:514} INFO - driverMemory            null
[2021-12-29 12:59:59,685] {spark_submit.py:514} INFO - driverCores             null
[2021-12-29 13:00:00,408] {spark_submit.py:514} INFO - driverExtraClassPath    null
[2021-12-29 13:00:01,454] {spark_submit.py:514} INFO - driverExtraLibraryPath  null
[2021-12-29 13:00:01,793] {spark_submit.py:514} INFO - driverExtraJavaOptions  null
[2021-12-29 13:00:01,803] {spark_submit.py:514} INFO - supervise               false
[2021-12-29 13:00:01,824] {spark_submit.py:514} INFO - queue                   null
[2021-12-29 13:00:01,842] {spark_submit.py:514} INFO - numExecutors            null
[2021-12-29 13:00:01,962] {spark_submit.py:514} INFO - files                   null
[2021-12-29 13:00:02,094] {spark_submit.py:514} INFO - pyFiles                 null
[2021-12-29 13:00:02,164] {spark_submit.py:514} INFO - archives                null
[2021-12-29 13:00:02,285] {spark_submit.py:514} INFO - mainClass               null
[2021-12-29 13:00:02,390] {spark_submit.py:514} INFO - primaryResource         file:/opt/***/jobs/get_ads_per_county.py
[2021-12-29 13:00:02,963] {spark_submit.py:514} INFO - name                    scrap data
[2021-12-29 13:00:03,080] {spark_submit.py:514} INFO - childArgs               [wicklow]
[2021-12-29 13:00:03,387] {spark_submit.py:514} INFO - jars                    null
[2021-12-29 13:00:03,470] {spark_submit.py:514} INFO - packages                null
[2021-12-29 13:00:03,547] {spark_submit.py:514} INFO - packagesExclusions      null
[2021-12-29 13:00:03,959] {spark_submit.py:514} INFO - repositories            null
[2021-12-29 13:00:03,994] {spark_submit.py:514} INFO - verbose                 true
[2021-12-29 13:00:04,234] {spark_submit.py:514} INFO - 
[2021-12-29 13:00:04,367] {spark_submit.py:514} INFO - Spark properties used, including those specified through
[2021-12-29 13:00:04,466] {spark_submit.py:514} INFO - --conf and those from the properties file null:
[2021-12-29 13:00:04,667] {spark_submit.py:514} INFO - (spark.master,spark://spark:7077)
[2021-12-29 13:00:04,893] {spark_submit.py:514} INFO - 
[2021-12-29 13:00:04,930] {spark_submit.py:514} INFO - 
[2021-12-29 13:26:34,967] {local_task_job.py:142} ERROR - Heartbeat time limit exceeded!
[2021-12-29 13:31:53,500] {process_utils.py:100} INFO - Sending Signals.SIGTERM to GPID 33643
[2021-12-29 13:33:12,177] {taskinstance.py:1411} ERROR - Received SIGTERM. Terminating subprocesses.
[2021-12-29 13:34:09,333] {spark_submit.py:644} INFO - Sending kill signal to spark-submit
[2021-12-29 13:34:01,756] {process_utils.py:113} WARNING - process psutil.Process(pid=33643, name='airflow task ru', status='running', started='12:47:47') did not respond to SIGTERM. Trying SIGKILL
[2021-12-29 13:44:50,794] {process_utils.py:113} WARNING - process psutil.Process(pid=33666, name='java', status='zombie', started='12:47:56') did not respond to SIGTERM. Trying SIGKILL
[2021-12-29 13:46:46,280] {process_utils.py:124} ERROR - Process psutil.Process(pid=33643, name='airflow task ru', status='running', started='12:47:47') (33643) could not be killed. Giving up.
[2021-12-29 13:47:45,962] {process_utils.py:124} ERROR - Process psutil.Process(pid=33666, name='java', status='zombie', started='12:47:56') (33666) could not be killed. Giving up.
[2021-12-29 13:48:48,039] {standard_task_runner.py:135} ERROR - Job 5382 was killed before it finished (likely due to running out of memory)
